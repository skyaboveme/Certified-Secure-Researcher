---
import Chatbot from "../components/Chatbot.astro";

interface Props {
	title: string;
	description?: string;
	image?: string;
	type?: string;
	keywords?: string;
}

const {
	title,
	description = "Certified Secure Researcher™ (CSR) provides official research security certification linked to ORCiD identifiers. Streamline compliance with federal funding agency standards and institutional security requirements.",
	image = "/logomain.png",
	type = "website",
	keywords = "research security, CSR certification, ORCiD, NSPM-33, research compliance, federal funding, intellectual property protection, research integrity, secure researcher certification",
} = Astro.props;

const siteUrl = "https://certifiedsecureresearcher.com";
const canonicalURL = new URL(Astro.url.pathname, siteUrl);
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/png" href="/logomain.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="generator" content={Astro.generator} />

		<!-- Primary Meta Tags -->
		<title>{title}</title>
		<meta name="title" content={title} />
		<meta name="description" content={description} />
		<meta name="keywords" content={keywords} />
		<meta name="author" content="IPTalons" />
		<meta name="robots" content="index, follow" />
		<link rel="canonical" href={canonicalURL} />

		<!-- Open Graph / Facebook -->
		<meta property="og:type" content={type} />
		<meta property="og:url" content={canonicalURL} />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:image" content={`${siteUrl}${image}`} />
		<meta property="og:site_name" content="Certified Secure Researcher™" />
		<meta property="og:locale" content="en_US" />

		<!-- Twitter -->
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:url" content={canonicalURL} />
		<meta name="twitter:title" content={title} />
		<meta name="twitter:description" content={description} />
		<meta name="twitter:image" content={`${siteUrl}${image}`} />

		<!-- Additional SEO -->
		<meta name="theme-color" content="#2d7a3e" />
		<meta name="apple-mobile-web-app-title" content="CSR" />
		<meta name="application-name" content="Certified Secure Researcher" />

		<!-- Fonts -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Space+Grotesk:wght@600;700&display=swap"
			rel="stylesheet"
		/>

		<!-- Structured Data -->
		<script type="application/ld+json" is:inline>
			{
				"@context": "https://schema.org",
				"@type": "Organization",
				"name": "Certified Secure Researcher",
				"alternateName": "CSR",
				"url": "https://certifiedsecureresearcher.com",
				"logo": "https://certifiedsecureresearcher.com/logomain.png",
				"description": "Official research security certification program linking researcher credentials to ORCiD identifiers for federal compliance.",
				"foundingDate": "2024",
				"areaServed": "Worldwide",
				"parentOrganization": {
					"@type": "Organization",
					"name": "IPTalons",
					"url": "https://iptalons.com"
				},
				"sameAs": [],
				"contactPoint": {
					"@type": "ContactPoint",
					"contactType": "customer service",
					"email": "support@certifiedsecureresearcher.com",
					"availableLanguage": "English"
				},
				"offers": {
					"@type": "Offer",
					"name": "CSR Certification",
					"description": "Research security certification for compliance with federal funding requirements"
				}
			}
		</script>

		<!-- Google tag (gtag.js) -->
		<script
			async
			src="https://www.googletagmanager.com/gtag/js?id=G-7SLS5XS68D"
		></script>
		<script is:inline>
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag("js", new Date());

			gtag("config", "G-7SLS5XS68D");
		</script>

		<!-- Google Tag Manager -->
		<script is:inline>
			(function (w, d, s, l, i) {
				w[l] = w[l] || [];
				w[l].push({
					"gtm.start": new Date().getTime(),
					event: "gtm.js",
				});
				var f = d.getElementsByTagName(s)[0],
					j = d.createElement(s),
					dl = l != "dataLayer" ? "&l=" + l : "";
				j.async = true;
				j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
				f.parentNode.insertBefore(j, f);
			})(window, document, "script", "dataLayer", "GTM-NFFC9W4V");
		</script>
		<!-- End Google Tag Manager -->
	</head>
	<body>
		<!-- Google Tag Manager (noscript) -->
		<noscript
			><iframe
				src="https://www.googletagmanager.com/ns.html?id=GTM-NFFC9W4V"
				height="0"
				width="0"
				style="display:none;visibility:hidden"></iframe></noscript
		>
		<!-- End Google Tag Manager (noscript) -->
		<slot />
		<Chatbot />
	</body>
</html>

<style is:global>
	* {
		margin: 0;
		padding: 0;
		box-sizing: border-box;
	}

	:root {
		--primary: #2d7a3e;
		--primary-dark: #1f5d2e;
		--primary-light: #3d9a51;
		--secondary: #50b661;
		--accent: #7ec74a;
		--dark: #1a3a22;
		--gray: #4a5568;
		--light-gray: #e2e8f0;
		--bg: #f7fafc;
		--white: #ffffff;
		--danger: #c53030;
		--success: #2d7a3e;
		--border: #2d3748;
	}

	html {
		scroll-behavior: smooth;
	}

	body {
		font-family:
			"Inter",
			system-ui,
			-apple-system,
			sans-serif;
		line-height: 1.6;
		color: var(--dark);
		background: var(--white);
	}

	h1,
	h2,
	h3,
	h4,
	h5,
	h6 {
		font-family: "Space Grotesk", sans-serif;
		font-weight: 700;
		line-height: 1.2;
		color: var(--dark);
	}

	.container {
		width: 100%;
		max-width: 1200px;
		margin: 0 auto;
		padding: 0 1.5rem;
	}

	.btn {
		display: inline-block;
		padding: 0.875rem 1.75rem;
		border-radius: 0.5rem;
		font-weight: 600;
		text-decoration: none;
		transition: all 0.2s;
		cursor: pointer;
		border: none;
	}

	.btn-primary {
		background: var(--primary);
		color: white;
	}

	.btn-primary:hover {
		background: var(--primary-dark);
		transform: translateY(-2px);
	}

	.btn-secondary {
		background: transparent;
		color: var(--primary);
		border: 2px solid var(--primary);
	}

	.btn-secondary:hover {
		background: var(--primary);
		color: white;
	}

	@media (max-width: 768px) {
		.container {
			padding: 0 1rem;
		}
	}
</style>

<script>
	document.addEventListener("DOMContentLoaded", () => {
		// Fade-in animations
		const fadeObserver = new IntersectionObserver(
			(entries) => {
				entries.forEach((entry) => {
					if (entry.isIntersecting) {
						entry.target.classList.add("visible");
					}
				});
			},
			{
				threshold: 0.1,
			},
		);

		document.querySelectorAll(".fade-in").forEach((el) => {
			fadeObserver.observe(el);
		});

		// Lazy loading for images
		const imageObserver = new IntersectionObserver(
			(entries) => {
				entries.forEach((entry) => {
					if (entry.isIntersecting) {
						const img = entry.target as HTMLImageElement;
						if (img.dataset.src) {
							img.src = img.dataset.src;
							img.removeAttribute("data-src");
						}
						imageObserver.unobserve(img);
					}
				});
			},
			{
				rootMargin: "50px",
			},
		);

		// Apply lazy loading to all images without loading="lazy" attribute
		document.querySelectorAll("img:not([loading])").forEach((img) => {
			img.setAttribute("loading", "lazy");
		});
	});
</script>
